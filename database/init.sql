CREATE TABLE IF NOT EXISTS clients (
    client_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL
);

CREATE TABLE IF NOT EXISTS payment_methods (
    payment_method_id SERIAL PRIMARY KEY,
    name VARCHAR(50) NOT NULL
);

CREATE TABLE iF NOT EXISTS transactions (
    id SERIAL PRIMARY KEY,
    date TIMESTAMP NOT NULL,
    client_id INT NOT NULL,
    amount NUMERIC(12, 2) NOT NULL,
    payment_method_id INT NOT NULL,
    CONSTRAINT fk_transactions_client FOREIGN KEY (client_id) REFERENCES clients(client_id),
    CONSTRAINT fk_transactions_payment_method FOREIGN KEY (payment_method_id) REFERENCES payment_methods(payment_method_id)
);

INSERT INTO clients (client_id, name) VALUES
(101, 'Ana Torres'),
(102, 'Luis Gómez'),
(103, 'Laura Ruiz'),
(104, 'Pedro Mejía'),
(105, 'Sofía Vargas'),
(106, 'Carlos Pérez'),
(107, 'Valentina Díaz'),
(108, 'Javier López'),
(109, 'Mariana Castro'),
(110, 'Andrés Silva'),
(111, 'Sebastian Gomez');


INSERT INTO payment_methods (payment_method_id, name) VALUES
(1, 'Transferencia'),
(2, 'Nequi'),
(3, 'Daviplata');


INSERT INTO transactions (id, date, client_id, amount, payment_method_id) VALUES
(1, '2025-05-01', 101, 45000.00, 1),
(2, '2025-05-02', 102, 30000.00, 2),
(3, '2025-05-03', 101, 20000.00, 3),
(4, '2025-05-04', 103, 50000.00, 1),
(5, '2025-05-05', 104, 10000.00, 2);


SELECT setval('clients_client_id_seq', 111, true);
SELECT setval('payment_methods_payment_method_id_seq', 3, true);
SELECT setval('transactions_id_seq', 5, true);

INSERT INTO transactions (date, client_id, amount, payment_method_id) VALUES
('2025-01-05', 103, 234500.00, 1),
('2025-03-12', 108, 156000.00, 2),
('2025-02-20', 101, 87000.00, 3),
('2025-04-01', 109, 312000.00, 1),
('2025-01-18', 105, 56000.00, 2),
('2025-05-22', 102, 410000.00, 3),
('2025-03-01', 110, 115000.00, 1),
('2025-02-10', 107, 289000.00, 2),
('2025-04-15', 104, 198000.00, 3),
('2025-01-25', 106, 35000.00, 1),
('2025-05-10', 101, 480000.00, 2),
('2025-03-28', 109, 92000.00, 3),
('2025-02-05', 105, 175000.00, 1),
('2025-04-22', 102, 333000.00, 2),
('2025-01-30', 110, 68000.00, 3),
('2025-05-18', 107, 210000.00, 1),
('2025-03-18', 104, 390000.00, 2),
('2025-02-15', 106, 130000.00, 3),
('2025-04-08', 103, 450000.00, 1),
('2025-01-10', 108, 25000.00, 2),
('2025-05-03', 109, 375000.00, 3),
('2025-03-22', 101, 165000.00, 1),
('2025-02-25', 105, 295000.00, 2),
('2025-04-29', 102, 78000.00, 3),
('2025-01-02', 110, 420000.00, 1),
('2025-05-20', 107, 105000.00, 2),
('2025-03-05', 104, 320000.00, 3),
('2025-02-28', 106, 185000.00, 1),
('2025-04-12', 103, 50000.00, 2),
('2025-01-15', 108, 460000.00, 3),
('2025-05-25', 109, 120000.00, 1),
('2025-03-30', 101, 270000.00, 2),
('2025-02-01', 105, 98000.00, 3),
('2025-04-18', 102, 355000.00, 1),
('2025-01-20', 110, 140000.00, 2),
('2025-05-15', 107, 430000.00, 3),
('2025-03-10', 104, 60000.00, 1),
('2025-02-22', 106, 240000.00, 2),
('2025-04-05', 103, 380000.00, 3),
('2025-01-28', 108, 110000.00, 1),
('2025-05-08', 109, 490000.00, 2),
('2025-03-15', 101, 75000.00, 3),
('2025-02-08', 105, 300000.00, 1),
('2025-04-25', 102, 150000.00, 2),
('2025-01-01', 110, 400000.00, 3),
('2025-05-23', 107, 190000.00, 1),
('2025-03-25', 104, 330000.00, 2),
('2025-02-18', 106, 80000.00, 3),
('2025-04-01', 103, 470000.00, 1),
('2025-01-12', 108, 210000.00, 2),
('2025-05-12', 109, 360000.00, 3),
('2025-03-08', 101, 100000.00, 1),
('2025-02-03', 105, 260000.00, 2),
('2025-04-20', 102, 170000.00, 3),
('2025-01-22', 110, 440000.00, 1),
('2025-05-17', 107, 90000.00, 2),
('2025-03-12', 104, 310000.00, 3),
('2025-02-25', 106, 220000.00, 1),
('2025-04-03', 103, 55000.00, 2),
('2025-01-08', 108, 480000.00, 3),
('2025-05-05', 109, 135000.00, 1),
('2025-03-18', 101, 280000.00, 2),
('2025-02-12', 105, 70000.00, 3),
('2025-04-27', 102, 345000.00, 1),
('2025-01-25', 110, 160000.00, 2),
('2025-05-21', 107, 415000.00, 3),
('2025-03-01', 104, 65000.00, 1),
('2025-02-19', 106, 255000.00, 2),
('2025-04-10', 103, 395000.00, 3),
('2025-01-03', 108, 125000.00, 1),
('2025-05-01', 109, 475000.00, 2),
('2025-03-20', 101, 82000.00, 3),
('2025-02-15', 105, 305000.00, 1),
('2025-04-22', 102, 145000.00, 2),
('2025-01-15', 110, 405000.00, 3),
('2025-05-19', 107, 180000.00, 1),
('2025-03-28', 104, 335000.00, 2),
('2025-02-05', 106, 95000.00, 3),
('2025-04-15', 103, 465000.00, 1),
('2025-01-10', 108, 225000.00, 2),
('2025-05-10', 109, 370000.00, 3),
('2025-03-05', 101, 105000.00, 1),
('2025-02-28', 105, 265000.00, 2),
('2025-04-29', 102, 165000.00, 3),
('2025-01-28', 110, 435000.00, 1),
('2025-05-24', 107, 115000.00, 2),
('2025-03-25', 104, 305000.00, 3),
('2025-02-01', 106, 72000.00, 1),
('2025-04-08', 103, 495000.00, 2),
('2025-01-05', 108, 205000.00, 3),
('2025-05-03', 109, 385000.00, 1),
('2025-03-22', 101, 90000.00, 2),
('2025-02-22', 105, 275000.00, 3),
('2025-04-25', 102, 155000.00, 1),
('2025-01-20', 110, 455000.00, 2),
('2025-05-15', 107, 175000.00, 3),
('2025-03-15', 104, 325000.00, 1),
('2025-02-08', 106, 88000.00, 2),
('2025-04-12', 103, 475000.00, 3),
('2025-01-12', 108, 215000.00, 1),
('2025-05-08', 109, 365000.00, 2),
('2025-03-01', 101, 115000.00, 3),
('2025-02-28', 105, 255000.00, 1),
('2025-04-18', 102, 175000.00, 2),
('2025-01-18', 110, 425000.00, 3),
('2025-05-22', 107, 100000.00, 1),
('2025-03-20', 104, 315000.00, 2),
('2025-02-15', 106, 78000.00, 3),
('2025-04-05', 103, 485000.00, 1),
('2025-01-18', 101, 150000.00, 1),
('2025-03-05', 101, 280000.00, 1),
('2025-04-22', 101, 95000.00, 1),
('2025-05-09', 101, 320000.00, 1),
('2025-05-11', 101, 450000.00, 1),
('2025-05-13', 101, 210000.00, 1),
('2025-02-10', 102, 75000.00, 2),
('2025-03-28', 102, 190000.00, 2),
('2025-04-15', 102, 315000.00, 2),
('2025-05-10', 102, 410000.00, 2),
('2025-05-11', 102, 480000.00, 2),
('2025-05-12', 102, 350000.00, 2),
('2025-01-25', 103, 220000.00, 3),
('2025-03-12', 103, 110000.00, 3),
('2025-04-01', 103, 390000.00, 3),
('2025-05-08', 103, 430000.00, 3),
('2025-05-11', 103, 500000.00, 3),
('2025-05-14', 103, 370000.00, 3),
('2025-02-18', 104, 60000.00, 1),
('2025-03-30', 104, 250000.00, 1),
('2025-04-18', 104, 180000.00, 1),
('2025-05-07', 104, 300000.00, 1),
('2025-05-11', 104, 420000.00, 1),
('2025-05-15', 104, 230000.00, 1),
('2025-01-05', 105, 350000.00, 2),
('2025-02-22', 105, 130000.00, 2),
('2025-04-05', 105, 290000.00, 2),
('2025-05-06', 105, 380000.00, 2),
('2025-05-11', 105, 460000.00, 2),
('2025-05-16', 105, 260000.00, 2),
('2025-02-12', 106, 80000.00, 3),
('2025-03-25', 106, 330000.00, 3),
('2025-04-29', 106, 160000.00, 3),
('2025-05-05', 106, 400000.00, 3),
('2025-05-11', 106, 490000.00, 3),
('2025-05-17', 106, 310000.00, 3),
('2025-01-30', 107, 200000.00, 1),
('2025-03-18', 107, 140000.00, 1),
('2025-04-12', 107, 360000.00, 1),
('2025-05-04', 107, 440000.00, 1),
('2025-05-11', 107, 500000.00, 1),
('2025-05-18', 107, 270000.00, 1),
('2025-02-03', 108, 90000.00, 2),
('2025-03-22', 108, 270000.00, 2),
('2025-04-25', 108, 195000.00, 2),
('2025-05-03', 108, 330000.00, 2),
('2025-05-11', 108, 470000.00, 2),
('2025-05-19', 108, 240000.00, 2),
('2025-01-12', 109, 310000.00, 3),
('2025-02-28', 109, 170000.00, 3),
('2025-04-08', 109, 250000.00, 3),
('2025-05-02', 109, 390000.00, 3),
('2025-05-11', 109, 440000.00, 3),
('2025-05-20', 109, 300000.00, 3),
('2025-02-05', 110, 115000.00, 1),
('2025-03-15', 110, 295000.00, 1),
('2025-04-20', 110, 225000.00, 1),
('2025-05-01', 110, 360000.00, 1),
('2025-05-11', 110, 410000.00, 1),
('2025-05-21', 110, 200000.00, 1),
('2025-01-20', 101, 180000.00, 1),
('2025-03-10', 101, 300000.00, 1),
('2025-04-25', 101, 110000.00, 1),
('2025-05-06', 101, 350000.00, 1),
('2025-05-11', 101, 470000.00, 1),
('2025-05-16', 101, 220000.00, 1),
('2025-02-15', 102, 85000.00, 2),
('2025-04-01', 102, 210000.00, 2),
('2025-04-29', 102, 335000.00, 2),
('2025-05-05', 102, 430000.00, 2),
('2025-05-11', 102, 495000.00, 2),
('2025-05-17', 102, 365000.00, 2),
('2025-01-28', 103, 240000.00, 3),
('2025-03-15', 103, 130000.00, 3),
('2025-04-10', 103, 410000.00, 3),
('2025-05-04', 103, 450000.00, 3),
('2025-05-11', 103, 500000.00, 3),
('2025-05-18', 103, 390000.00, 3),
('2025-02-25', 104, 70000.00, 1),
('2025-04-12', 104, 270000.00, 1),
('2025-05-01', 104, 200000.00, 1),
('2025-05-09', 104, 320000.00, 1),
('2025-05-11', 104, 430000.00, 1),
('2025-05-20', 104, 250000.00, 1),
('2025-01-10', 105, 370000.00, 2),
('2025-03-20', 105, 150000.00, 2),
('2025-04-18', 105, 310000.00, 2),
('2025-05-03', 105, 400000.00, 2),
('2025-05-11', 105, 480000.00, 2),
('2025-05-22', 105, 280000.00, 2),
('2025-02-19', 106, 95000.00, 3),
('2025-04-03', 106, 350000.00, 3),
('2025-05-02', 106, 180000.00, 3),
('2025-05-07', 106, 420000.00, 3),
('2025-05-11', 106, 500000.00, 3),
('2025-05-23', 106, 330000.00, 3),
('2025-01-15', 107, 215000.00, 1),
('2025-03-28', 107, 155000.00, 1),
('2025-04-15', 107, 375000.00, 1),
('2025-05-01', 107, 455000.00, 1),
('2025-05-11', 107, 500000.00, 1),
('2025-05-24', 107, 285000.00, 1),
('2025-02-08', 108, 105000.00, 2),
('2025-03-25', 108, 285000.00, 2),
('2025-04-22', 108, 205000.00, 2),
('2025-05-09', 108, 340000.00, 2),
('2025-05-11', 108, 485000.00, 2),
('2025-05-25', 108, 255000.00, 2),
('2025-01-22', 109, 330000.00, 3),
('2025-03-12', 109, 190000.00, 3),
('2025-04-01', 109, 270000.00, 3),
('2025-05-08', 109, 410000.00, 3),
('2025-05-11', 109, 460000.00, 3),
('2025-05-15', 109, 320000.00, 3),
('2025-02-15', 110, 135000.00, 1),
('2025-04-05', 110, 315000.00, 1),
('2025-04-29', 110, 245000.00, 1),
('2025-05-07', 110, 380000.00, 1),
('2025-05-11', 110, 430000.00, 1),
('2025-05-26', 110, 215000.00, 1),
('2025-01-08', 101, 165000.00, 1),
('2025-03-22', 101, 290000.00, 1),
('2025-04-18', 101, 105000.00, 1),
('2025-05-05', 101, 335000.00, 1),
('2025-05-11', 101, 465000.00, 1),
('2025-05-17', 101, 235000.00, 1),
('2025-02-20', 102, 105000.00, 2),
('2025-04-08', 102, 230000.00, 2),
('2025-05-02', 102, 365000.00, 2),
('2025-05-11', 102, 490000.00, 2),
('2025-05-18', 102, 385000.00, 2),
('2025-01-31', 103, 260000.00, 3),
('2025-03-20', 103, 150000.00, 3),
('2025-04-15', 103, 420000.00, 3),
('2025-05-01', 103, 470000.00, 3),
('2025-05-11', 103, 500000.00, 3),
('2025-05-19', 103, 405000.00, 3),
('2025-02-01', 104, 120000.00, 1),
('2025-04-22', 104, 290000.00, 1),
('2025-05-03', 104, 220000.00, 1),
('2025-05-11', 104, 440000.00, 1),
('2025-05-21', 104, 260000.00, 1),
('2025-01-15', 105, 390000.00, 2),
('2025-03-25', 105, 170000.00, 2),
('2025-05-02', 105, 330000.00, 2),
('2025-05-11', 105, 470000.00, 2),
('2025-05-23', 105, 300000.00, 2),
('2025-02-25', 106, 110000.00, 3),
('2025-04-12', 106, 370000.00, 3),
('2025-05-01', 106, 200000.00, 3),
('2025-05-11', 106, 480000.00, 3),
('2025-05-24', 106, 350000.00, 3),
('2025-02-08', 107, 230000.00, 1),
('2025-04-01', 107, 170000.00, 1),
('2025-05-03', 107, 400000.00, 1),
('2025-05-11', 107, 500000.00, 1),
('2025-05-25', 107, 310000.00, 1),
('2025-02-18', 108, 130000.00, 2),
('2025-04-05', 108, 300000.00, 2),
('2025-05-04', 108, 230000.00, 2),
('2025-05-11', 108, 490000.00, 2),
('2025-05-26', 108, 270000.00, 2),
('2025-02-01', 109, 350000.00, 3),
('2025-04-29', 109, 210000.00, 3),
('2025-05-05', 109, 380000.00, 3),
('2025-05-11', 109, 450000.00, 3),
('2025-05-17', 109, 340000.00, 3),
('2025-02-10', 110, 155000.00, 1),
('2025-04-18', 110, 335000.00, 1),
('2025-05-06', 110, 265000.00, 1),
('2025-05-11', 110, 420000.00, 1),
('2025-05-22', 110, 225000.00, 1),
('2025-01-25', 101, 195000.00, 1),
('2025-04-03', 101, 315000.00, 1),
('2025-05-07', 101, 365000.00, 1),
('2025-05-11', 101, 485000.00, 1),
('2025-05-20', 101, 255000.00, 1),
('2025-02-12', 102, 115000.00, 2),
('2025-04-25', 102, 250000.00, 2),
('2025-05-05', 102, 405000.00, 2),
('2025-05-11', 102, 495000.00, 2),
('2025-05-21', 102, 375000.00, 2),
('2025-02-15', 103, 275000.00, 3),
('2025-04-22', 103, 165000.00, 3),
('2025-05-06', 103, 445000.00, 3),
('2025-05-11', 103, 500000.00, 3),
('2025-05-22', 103, 415000.00, 3),
('2025-02-22', 104, 145000.00, 1),
('2025-04-01', 104, 305000.00, 1),
('2025-05-08', 104, 235000.00, 1),
('2025-05-11', 104, 455000.00, 1),
('2025-05-23', 104, 275000.00, 1),
('2025-01-18', 105, 405000.00, 2),
('2025-04-08', 105, 185000.00, 2),
('2025-05-01', 105, 345000.00, 2),
('2025-05-11', 105, 485000.00, 2),
('2025-05-24', 105, 315000.00, 2),
('2025-02-28', 106, 125000.00, 3),
('2025-04-15', 106, 385000.00, 3),
('2025-05-03', 106, 215000.00, 3),
('2025-05-11', 106, 495000.00, 3),
('2025-05-25', 106, 365000.00, 3),
('2025-02-05', 107, 245000.00, 1),
('2025-04-29', 107, 185000.00, 1),
('2025-05-05', 107, 415000.00, 1),
('2025-05-11', 107, 500000.00, 1),
('2025-05-26', 107, 295000.00, 1),
('2025-02-22', 108, 145000.00, 2),
('2025-04-12', 108, 315000.00, 2),
('2025-05-06', 108, 245000.00, 2),
('2025-05-11', 108, 495000.00, 2),
('2025-05-17', 108, 285000.00, 2),
('2025-02-15', 109, 365000.00, 3),
('2025-04-01', 109, 225000.00, 3),
('2025-05-07', 109, 395000.00, 3),
('2025-05-11', 109, 455000.00, 3),
('2025-05-18', 109, 355000.00, 3),
('2025-02-08', 110, 175000.00, 1),
('2025-04-25', 110, 355000.00, 1),
('2025-05-05', 110, 285000.00, 1),
('2025-05-11', 110, 435000.00, 1),
('2025-05-23', 110, 235000.00, 1),
('2025-01-11', 111, 58000.00, 2), -- Sábado
('2025-01-25', 111, 62000.00, 2), -- Sábado
('2025-02-02', 111, 48000.00, 2), -- Domingo
('2025-02-15', 111, 78000.00, 2), -- Sábado
('2025-03-01', 111, 52000.00, 2), -- Sábado
('2025-03-16', 111, 68000.00, 2), -- Domingo
('2025-03-29', 111, 82000.00, 2), -- Sábado
('2025-04-13', 111, 45000.00, 2), -- Domingo
('2025-04-26', 111, 72000.00, 2), -- Sábado
('2025-05-10', 111, 66000.00, 2), -- Sábado
('2025-05-25', 111, 59000.00, 2), -- Domingo
('2025-01-18', 111, 135000.00, 1), -- Sábado (ocasional método 1)
('2025-02-16', 111, 115000.00, 1), -- Domingo (ocasional método 1)
('2025-03-30', 111, 120000.00, 1), -- Domingo (ocasional método 1)
('2025-04-27', 111, 105000.00, 1), -- Domingo (ocasional método 1)
('2025-05-26', 111, 130000.00, 1), -- Lunes (ocasional método 1)
('2025-01-05', 111, 38000.00, 2), -- Domingo
('2025-01-19', 111, 71000.00, 2), -- Domingo
('2025-02-01', 111, 51000.00, 2), -- Sábado
('2025-02-23', 111, 63000.00, 2), -- Domingo
('2025-03-02', 111, 49000.00, 2), -- Domingo
('2025-03-15', 111, 79000.00, 2), -- Sábado
('2025-03-23', 111, 61000.00, 2), -- Domingo
('2025-04-06', 111, 42000.00, 2), -- Domingo
('2025-04-19', 111, 81000.00, 2), -- Sábado
('2025-05-04', 111, 69000.00, 2), -- Domingo
('2025-05-17', 111, 57000.00, 2), -- Sábado
('2025-01-12', 111, 95000.00, 2), -- Domingo (gasto un poco mayor)
('2025-02-23', 111, 88000.00, 2), -- Domingo (gasto un poco mayor)
('2025-03-09', 111, 92000.00, 2), -- Domingo (gasto un poco mayor)
('2025-04-20', 111, 98000.00, 2), -- Domingo (gasto un poco mayor)
('2025-05-18', 111, 91000.00, 2), -- Domingo (gasto un poco mayor)
('2025-01-06', 111, 32000.00, 2), -- Lunes
('2025-01-20', 111, 41000.00, 2), -- Lunes
('2025-02-03', 111, 39000.00, 2), -- Lunes
('2025-02-17', 111, 46000.00, 2), -- Lunes
('2025-03-03', 111, 37000.00, 2), -- Lunes
('2025-03-17', 111, 43000.00, 2), -- Lunes
('2025-03-31', 111, 34000.00, 2), -- Lunes
('2025-04-14', 111, 40000.00, 2), -- Lunes
('2025-04-28', 111, 36000.00, 2), -- Lunes
('2025-05-12', 111, 44000.00, 2), -- Lunes
('2025-01-13', 111, 73000.00, 2), -- Domingo
('2025-02-24', 111, 67000.00, 2), -- Lunes
('2025-03-10', 111, 76000.00, 2), -- Lunes
('2025-04-21', 111, 70000.00, 2), -- Lunes
('2025-05-19', 111, 74000.00, 2), -- Lunes
('2025-01-07', 111, 118000.00, 1), -- Martes (ocasional método 1)
('2025-02-18', 111, 102000.00, 1), -- Martes (ocasional método 1)
('2025-03-11', 111, 122000.00, 1), -- Martes (ocasional método 1)
('2025-04-22', 111, 108000.00, 1), -- Martes (ocasional método 1)
('2025-05-20', 111, 112000.00, 1), -- Martes (ocasional método 1)
('2025-01-09', 111, 51000.00, 2), -- Jueves
('2025-01-23', 111, 55000.00, 2), -- Jueves
('2025-02-06', 111, 49000.00, 2), -- Jueves
('2025-02-20', 111, 53000.00, 2), -- Jueves
('2025-03-06', 111, 47000.00, 2), -- Jueves
('2025-03-20', 111, 50000.00, 2), -- Jueves
('2025-04-03', 111, 52000.00, 2), -- Jueves
('2025-04-17', 111, 56000.00, 2), -- Jueves
('2025-05-01', 111, 54000.00, 2), -- Jueves
('2025-05-15', 111, 58000.00, 2), -- Jueves
('2025-01-10', 111, 85000.00, 2), -- Viernes (gasto un poco mayor)
('2025-02-21', 111, 90000.00, 2), -- Viernes (gasto un poco mayor)
('2025-03-14', 111, 88000.00, 2), -- Viernes (gasto un poco mayor)
('2025-04-18', 111, 93000.00, 2), -- Viernes (gasto un poco mayor)
('2025-05-16', 111, 91000.00, 2), -- Viernes (gasto un poco mayor)
('2025-01-04', 111, 40000.00, 2), -- Sábado (múltiple transacción)
('2025-02-15', 111, 35000.00, 2), -- Sábado (múltiple transacción)
('2025-03-08', 111, 42000.00, 2), -- Sábado (múltiple transacción)
('2025-04-26', 111, 38000.00, 2), -- Sábado (múltiple transacción)
('2025-05-24', 111, 41000.00, 2), -- Sábado (múltiple transacción)
('2025-01-04', 111, 110000.00, 1), -- Sábado (ocasional método 1, múltiple transacción)
('2025-03-29', 111, 105000.00, 1), -- Sábado (ocasional método 1)
('2025-01-27', 111, 61000.00, 2), -- Lunes
('2025-02-10', 111, 57000.00, 2), -- Lunes
('2025-03-03', 111, 64000.00, 2), -- Lunes
('2025-04-07', 111, 59000.00, 2), -- Lunes
('2025-05-19', 111, 62000.00, 2)  -- Lunes
;

SELECT setval('transactions_id_seq', 415, true);